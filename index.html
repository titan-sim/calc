<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dino Mutant ì‹œë®¬ë ˆì´í„° Pro</title>
<style>
        body { font-family: 'Pretendard', sans-serif; padding: 20px; background-color: #f8f9fa; color: #333; max-width: 800px; margin: 0 auto; line-height: 1.6; }
        .warning { font-size: 12px; color: #999; text-align: center; margin-bottom: 15px; }
        .card { background: #ffffff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-bottom: 20px; border: 1px solid #eee; }
        .input-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
        label { display: block; font-weight: 600; margin-bottom: 6px; font-size: 13px; color: #555; }
        input, select { padding: 10px 12px; border: 1px solid #ddd; border-radius: 8px; width: 100%; box-sizing: border-box; font-size: 14px; }
        .slot-container { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin: 15px 0; }
        .slot { aspect-ratio: 1; border: 2px dashed #ddd; border-radius: 10px; display: flex; align-items: center; justify-content: center; background: #fafafa; cursor: pointer; overflow: hidden; }
        .slot.active { border: 2px solid #2196F3; background-color: #e3f2fd; }
        .slot img { width: 100%; height: 100%; object-fit: cover; }
        #runePicker { border-top: 1px solid #eee; padding-top: 20px; display: none; }
        .rune-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px; max-height: 400px; overflow-y: auto; }
        .rune-item { cursor: pointer; text-align: center; border: 2px solid transparent; padding: 8px; border-radius: 10px; background: #fff; box-shadow: 0 2px 4px rgba(0,0,0,0.04); }
        .rune-item img { width: 54px; height: 54px; border-radius: 8px; }
        .rune-item span { font-size: 11px; display: block; margin-top: 5px; }
        .detail-card { background: #fcfcfc; border: 1px solid #eee; padding: 20px; border-radius: 10px; margin-top: 15px; }
        .rune-grade { font-size: 11px; font-weight: bold; padding: 3px 8px; border-radius: 4px; display: inline-block; margin-bottom: 10px; }
        .grade-ì¼ë°˜ { background: #E3F2FD; color: #1976D2; }
        .grade-í¬ê·€ { background: #E8F5E9; color: #2E7D32; }
        .grade-ì—í”½ { background: #FFFDE7; color: #FBC02D; }
        .grade-ìœ ë‹ˆí¬ { background: #FFF3E0; color: #EF6C00; }
        .grade-ì „ì„¤ { background: #FFEBEE; color: #C62828; border: 1px solid #FFCDD2; }
        .stat-summary { background: #f0f7ff; padding: 15px; border-radius: 8px; margin-bottom: 10px; border: 1px solid #d0e3ff; font-size: 13px; }
        .stat-row { display: flex; justify-content: space-between; margin-bottom: 4px; }
        .btn-apply { background: #2196F3; color: white; border: none; padding: 12px; border-radius: 8px; width: 100%; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-remove { background: #f44336; color: white; border: none; padding: 12px; border-radius: 8px; width: 100%; font-weight: bold; cursor: pointer; margin-top: 8px; }
        .btn-sim { background: #4CAF50; color: white; border: none; padding: 15px; border-radius: 8px; width: 100%; font-weight: bold; font-size: 16px; cursor: pointer; transition: background 0.2s; }
        .btn-sim:hover { background: #43a047; }
        .result-box { text-align: center; }
        .res-val { font-weight: bold; color: #333; }
        .res-main { font-size: 24px; font-weight: bold; margin: 10px 0; }
</style>
</head>
<body>
<div class="warning">
	â€» ë³¸ ì‹œë®¬ë ˆì´í„°ëŠ” ì°¸ê³ ìš©ì´ë©°, ì‹¤ì œ ì—°ì‚° ë°©ì‹ê³¼ ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
</div>
<div class="card">
	<div class="input-grid">
		<div>
			<label>ê³µë£¡ ê³µê²©ë ¥</label><input type="number" id="baseAtk" value="1" oninput="updateLiveStats()" onfocus="this.select()">
		</div>
		<div>
			<label>ê³µë£¡ ì²´ë ¥</label><input type="number" id="baseHp" value="10" oninput="updateLiveStats()" onfocus="this.select()">
		</div>
		<div style="grid-column: span 2;">
			<label>ë‚´ ê³µë£¡ ìˆ˜</label>
			<select id="dinoCount" onchange="updateLiveStats()">
				<script>for(let i=1;i<=9;i++) document.write(`<option value="${i}">${i}ë§ˆë¦¬</option>`);</script>
			</select>
		</div>
	</div>
</div>
<div class="card">
	<div style="font-size: 14px; font-weight: bold; margin-bottom: 15px; color: #444; text-align: center;">
		ì¥ì°©ëœ ë£¬
	</div>
	<div class="slot-container">
		<script>for(let i=0;i<5;i++) document.write(`<div class="slot" id="slot${i}" onclick="openPicker(${i})"><small style="color:#ccc">ìŠ¬ë¡¯ ${i+1}</small></div>`);</script>
	</div>
	<div id="runePicker">
		<div class="rune-grid" id="runeGrid">
		</div>
		<div id="detailArea" class="detail-card" style="display:none;">
			<div id="runeGrade" class="rune-grade">
				ë“±ê¸‰
			</div>
			<div style="margin-bottom:12px;">
				<label>ë ˆë²¨ (1~31)</label>
				<select id="runeLevel" onchange="updateDetail()">
				</select>
			</div>
			<div id="runeDesc" style="font-size:13px; color:#444; margin: 10px 0; white-space: pre-line; background:#fff; padding:12px; border-radius:6px; border:1px solid #eee;">
			</div>
			<button class="btn-apply" onclick="applyToSlot()">ë£¬ ì¥ì°©í•˜ê¸°</button>
			<button id="removeBtn" class="btn-remove" onclick="removeRune()">ì¥ì°© í•´ì œ</button>
		</div>
	</div>
</div>
<div class="card" style="margin-bottom: 10px;">
	<label>íƒ€ì´íƒ„ ë ˆë²¨ ì„ íƒ</label>
	<select id="targetTitan" onchange="updateLiveStats()">
	</select>
	<div id="liveStats" class="stat-summary" style="margin-top:15px;">
	</div>
	<button class="btn-sim" onclick="startSimulation()">ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘</button>
</div>
<div class="card">
	<div id="finalStats" class="result-box">
		ê²°ê³¼ì°½
	</div>
</div>
<script>
                const RUNES_DATA = {
            "í": { grade: "ì¼ë°˜", imgId: "10kOU5_hHneBmIpMJ-Hx0FuN-UanR5FDN", desc: "ìœ ë‹›ì—ê²Œ ê³µê²©ë‹¹í•  ë•Œ {prob}% í™•ë¥ ë¡œ ë‚´ ìœ ë‹› ìµœëŒ€ ì²´ë ¥ì˜ {value}% íšŒë³µ", levels: (function(){ let lv={}; const data=[[5,1.0],[5,1.1],[5,1.2],[5,1.3],[5,1.4],[5,2.0],[5,2.1],[5,2.2],[5,2.3],[5,2.4],[8,2.5],[8,2.6],[8,2.7],[8,2.8],[8,2.9],[8,3.5],[8,3.6],[8,3.7],[8,3.8],[8,3.9],[10,4.0],[10,4.1],[10,4.2],[10,4.3],[10,4.4],[10,5.0],[10,5.1],[10,5.2],[10,5.3],[10,5.4],[13,8.0]]; data.forEach((d,i)=>lv[i+1]={prob:d[0], value:d[1]}); return lv; })() },
            "ê³µê²©ë ¥ ì¦ê°€ 1": { grade: "ì¼ë°˜", imgId: "1ihowBMqeNvWag_4ou2JLgYilpLGvgnPa", desc: "ìœ ë‹› ê³µê²©ë ¥ {value} ì¦ê°€", levels: (function(){ let lv={}; for(let i=1;i<=31;i++) lv[i]={value:i}; return lv; })() },
            "ì²´ë ¥ ì¦ê°€ 1": { grade: "ì¼ë°˜", imgId: "1vNpdtLIozfnNOhjl2-gIMFH33xLmgh3P", desc: "ìœ ë‹› ì²´ë ¥ {value} ì¦ê°€", levels: (function(){ let lv={}; for(let i=1;i<=31;i++) lv[i]={value:i*25}; return lv; })() },
            "í¬ìƒ": { grade: "ì¼ë°˜", imgId: "1Yuy6PLeo7Jx-fAef04PVuqmiZjR_mw64", desc: "ì‚¬ë§ ì‹œ {prob}% í™•ë¥ ë¡œ ê°™ì€ íƒ€ì¼ì— ìˆëŠ” ë™ì¼ ë¶€ì¡± ì†Œì† ìœ ë‹›ì—ê²Œ ë‚˜ì˜ ìœ ë‹› ìµœëŒ€ ì²´ë ¥ì˜ {value}% íšŒë³µ", levels: (function(){ let lv={}; const probs=[35,35,35,35,35,35,35,35,35,35,40,40,40,40,40,40,40,40,40,40,45,45,45,45,45,45,45,45,45,45,50]; const vals=[10.0,10.5,11.0,11.5,12.0,15.0,15.5,16.0,16.5,17.0,20.0,20.5,21.0,21.5,22.0,25.0,25.5,26.0,26.5,27.0,30.0,30.5,31.0,31.5,32.0,35.0,35.5,36.0,36.5,37.0,45.0]; probs.forEach((p,i)=>lv[i+1]={prob:p, value:vals[i]}); return lv; })() },
            "ë§ˆì§€ë§‰ ì„ ë¬¼": { grade: "ì¼ë°˜", imgId: "16X52VhA2_Z-UFH6bNFdqA_XkXwPdWZJg", desc: "ì‚¬ë§ ì‹œ {prob}% í™•ë¥ ë¡œ ê°™ì€ íƒ€ì¼ì— ìˆëŠ” ë™ì¼ ë¶€ì¡± ì†Œì†ì˜ ìœ ë‹›ì—ê²Œ ê³µê²©ë ¥ {value} ì¦ê°€ ë²„í”„ {turn}í„´ ì§€ì†", levels: (function(){ let lv={}; const probs=[40,40,40,40,40,40,40,40,40,40,45,45,45,45,45,45,45,45,45,45,50,50,50,50,50,50,50,50,50,50,60]; const turns=[1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4]; for(let i=1;i<=31;i++) lv[i]={prob:probs[i-1], value:14+i, turn:turns[i-1]}; return lv; })() },
            "íŠ¸ë¦¬í”Œ ì„íŒ©íŠ¸": { grade: "ì¼ë°˜", imgId: "1nO4CtfdB_FH7ZvCmL3uj1QPLDJte5mLB", desc: "ì„¸ ë²ˆì§¸ ê³µê²©ë§ˆë‹¤ ë‚´ ìœ ë‹› ê³µê²©ë ¥ì˜ {value}% ì¶”ê°€ í”¼í•´", levels: (function(){ let lv={}; const vals=[2.0,2.5,3.0,3.5,4.0,6.0,6.5,7.0,7.5,8.0,10.0,10.5,11.0,11.5,12.0,14.0,14.5,15.0,15.5,16.0,18.0,18.5,19.0,19.5,20.0,22.0,22.5,23.0,23.5,24.0,27.0]; vals.forEach((v,i)=>lv[i+1]={value:v}); return lv; })() },
            "ë‹¨ë‹¨í•œ í”¼ë¶€ 1": { grade: "ì¼ë°˜", imgId: "1oHu7Ep7BwL7Es4dBRVdTyfnSrfd_xIq1", desc: "ì  ìœ ë‹›ì—ê²Œ ê³µê²©ë‹¹í•  ë•Œ í”¼í•´ {value}ë§Œí¼ ê°ì†Œ", levels: (function(){ let lv={}; for(let i=1;i<=31;i++) lv[i]={value:i*2}; return lv; })() },
            "í”¼í•´ ì €í•­ 1": { grade: "ì¼ë°˜", imgId: "1tBCAdO-UyCTP32gHwEc7TVISeRINsrqa", desc: "ì  ìœ ë‹›ì—ê²Œ ê³µê²©ë‹¹í•  ë•Œ {prob}% í™•ë¥ ë¡œ í”¼í•´ {value}ë§Œí¼ ê°ì†Œ", levels: (function(){ let lv={}; const probs=[30,30,30,30,30,35,35,35,35,35,35,35,35,35,35,40,40,40,40,40,40,40,40,40,40,45,45,45,45,45,50]; const vals=[30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90]; probs.forEach((p,i)=>lv[i+1]={prob:p, value:vals[i]}); return lv; })() },
            "ë³´í˜¸ë§‰": { grade: "ì¼ë°˜", imgId: "1-FCajygUymZcpCCxaK7_Scg5NtiPKyiM", desc: "{turn}ë²ˆì˜ ì  ê³µê²© í”¼í•´ë¥¼ {value}% ê°ì†Œ", levels: (function(){ let lv={}; const vals=[1.0,1.5,2.0,2.5,3.0,5.0,5.5,6.0,6.5,7.0,10.0,10.5,11.0,11.5,12.0,13.0,13.5,14.0,14.5,15.0,18.0,18.5,19.0,19.5,20.0,22.0,22.5,23.0,23.5,24.0,28.0]; const turns=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3]; vals.forEach((v,i)=>lv[i+1]={value:v, turn:turns[i]}); return lv; })() },
            "ê³µê²©ë ¥ ì¦ê°€ 2": { grade: "í¬ê·€", imgId: "1PKky7_H1ZXJNxzZJhByTw7hUclQ0aTRG", desc: "ìœ ë‹› ê³µê²©ë ¥ {value} ì¦ê°€", levels: (function(){ let lv={}; for(let i=1;i<=31;i++) lv[i]={value:14+i}; return lv; })() },
            "ì²´ë ¥ ì¦ê°€ 2": { grade: "í¬ê·€", imgId: "1oIkxrSL3mVZo-fHXOv2Ot2Zmmftwpp3H", desc: "ìœ ë‹› ì²´ë ¥ {value} ì¦ê°€", levels: (function(){ let lv={}; for(let i=1;i<=31;i++) lv[i]={value:350+(i*25)}; return lv; })() },
            "í˜‘ë™ ê³µê²©": { grade: "í¬ê·€", imgId: "1DzFWPRILgHZAF28JrzUzKZQWKCtAN2vR", desc: "ê°™ì€ íƒ€ì¼ì— ë‚´ ìœ ë‹›ì´ 5ë§ˆë¦¬ ì´ìƒì¼ ë•Œ ìœ ë‹›ì˜ ê³µê²©ë ¥{atk} ì²´ë ¥{hp} ì¦ê°€", levels: (function(){ let lv={}; const atks=[35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,62,64,66,68,75]; const hps=[875,900,925,950,975,1000,1025,1050,1100,1125,1150,1175,1200,1225,1250,1275,1300,1325,1350,1375,1400,1425,1450,1475,1500,1550,1600,1650,1700,1875]; atks.forEach((a,i)=>lv[i+1]={atk:a, hp:hps[i]}); return lv; })() },
            "ê³ ë…í•œ ë¶„ë…¸": { grade: "í¬ê·€", imgId: "1hAyyAwatFwvlKqth4sunU_gURWoTY4ZJ", desc: "ê°™ì€ íƒ€ì¼ì— ë‚´ ìœ ë‹›ì´ 1ë§ˆë¦¬ì¼ ë•Œ ìœ ë‹›ì˜ ê³µê²©ë ¥ {atk} ì²´ë ¥ {hp} ì¦ê°€", levels: (function(){ let lv={}; for(let i=1;i<=31;i++) lv[i]={atk:14+i, hp:350+(i*25)}; return lv; })() },
            "ë‹¨ë‹¨í•œ í”¼ë¶€ 2": { grade: "í¬ê·€", imgId: "1XfdIrPSz_xm9v1KHB-TArpaRdv47zHLF", desc: "ì  ìœ ë‹›ì—ê²Œ ê³µê²©ë‹¹í•  ë•Œ í”¼í•´ {value}ë§Œí¼ ê°ì†Œ", levels: (function(){ let lv={}; const vals=[30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90]; vals.forEach((v,i)=>lv[i+1]={value:v}); return lv; })() },
            "í”¼í•´ ì €í•­ 2": { grade: "í¬ê·€", imgId: "13As5kbKRnyJA81fUClKxILhq8P9Rws0c", desc: "ì  ìœ ë‹›ì—ê²Œ ê³µê²©ë‹¹í•  ë•Œ {prob}%ì˜ í™•ë¥ ë¡œ í”¼í•´ {value}ë§Œí¼ ê°ì†Œ", levels: (function(){ let lv={}; const probs=[30,30,30,30,30,35,35,35,35,35,35,35,35,35,35,40,40,40,40,40,40,40,40,40,40,45,45,45,45,45,50]; const vals=[70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,118,120,124,128,132,136,150]; probs.forEach((p,i)=>lv[i+1]={prob:p, value:vals[i]}); return lv; })() },
            "ì¹˜ëª…íƒ€ í™•ë¥ ": { grade: "ì—í”½", imgId: "1rZUa6JfGfbksXt1qOO32veoEty9er_Bu", desc: "ìœ ë‹› ì¹˜ëª…íƒ€ í™•ë¥  {value}% ì¦ê°€", levels: (function(){ let lv={}; const vals=[13.0,13.3,13.6,13.9,14.2,17.0,17.3,17.6,17.9,18.2,21.0,21.3,21.6,21.9,22.2,25.0,25.5,26.0,26.5,27.0,30.0,30.5,31.0,31.5,32.0,35.0,35.5,36.0,36.5,37.0,40.0]; vals.forEach((v,i)=>lv[i+1]={value:v.toFixed(1)}); return lv; })() },
            "ì¹˜ëª…íƒ€ í”¼í•´": { grade: "ì—í”½", imgId: "127l8ExJLlQENOySkwk_TiNDLO5gKo7Rm", desc: "ìœ ë‹› ì¹˜ëª…íƒ€ í”¼í•´ëŸ‰ {value}% ì¦ê°€", levels: (function(){ let lv={}; const vals=[20.0,20.5,21.0,21.5,22.0,25.0,25.5,26.0,26.5,27.0,30.0,30.5,31.0,31.5,32.0,35.0,36.0,37.0,38.0,39.0,42.0,43.0,44.0,45.0,46.0,50.0,51.0,52.0,53.0,54.0,60.0]; vals.forEach((v,i)=>lv[i+1]={value:v.toFixed(1)}); return lv; })() },
            "ê³µê²©ë ¥ ì¦ê°€ 3": { grade: "ì—í”½", imgId: "1MBbzM8Snw4awmVoS-mBe1ATN_WlkcwqL", desc: "ìœ ë‹› ê³µê²©ë ¥ {value} ì¦ê°€", levels: (function(){ let lv={}; const vals=[35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,62,64,66,68,75]; vals.forEach((v,i)=>lv[i+1]={value:v}); return lv; })() },
            "ì²´ë ¥ ì¦ê°€ 3": { grade: "ì—í”½", imgId: "1r_tPl7V2ydsAD3p_amPfL1d92i-6AFLN", desc: "ìœ ë‹› ì²´ë ¥ {value} ì¦ê°€", levels: (function(){ let lv={}; const vals=[875,900,925,950,975,1000,1025,1050,1075,1100,1125,1150,1175,1200,1225,1250,1275,1300,1325,1350,1375,1400,1425,1450,1475,1500,1550,1600,1650,1700,1875]; vals.forEach((v,i)=>lv[i+1]={value:v}); return lv; })() },
            "ì£½ì„ ì¤€ë¹„": { grade: "ì—í”½", imgId: "1x77384PZAogZ_hTJeRH1iLXPrOfM5e_g", desc: "ì‚¬ë§ ì‹œ {prob}% í™•ë¥ ë¡œ í˜„ì¬ ì „íˆ¬ì¤‘ì¸ ìœ ë‹›ì—ê²Œ ë‚˜ì˜ ìœ ë‹›ì˜ ê³µê²©ë ¥ì˜ {value}% í”¼í•´", levels: (function(){ let lv={}; const probs=[80,80,80,80,80,80,80,80,80,80,85,85,85,85,85,85,85,85,85,85,90,90,90,90,90,90,90,90,90,90,100]; const vals=[50,51,52,53,54,60,61,62,63,64,66,67,68,69,70,76,77,78,79,80,82,83,84,85,86,90,91,92,93,94,100]; probs.forEach((p,i)=>lv[i+1]={prob:p, value:vals[i]}); return lv; })() },
            "ì••ì¶•ëœ í˜": { grade: "ì—í”½", imgId: "1aaijjlcR-GjrDeZy4WzBqFN2J7oBiw2C", desc: "ìœ ë‹›ì˜ í¬ê¸°ê°€ ì‘ì•„ì§€ë©° ìœ ë‹›ì˜ ê³µê²©ë ¥ì´ {atk}% ì¦ê°€í•˜ê³  ìµœëŒ€ ì²´ë ¥ì´ 25% ê°ì†Œ", levels: (function(){ let lv={}; const atks=[15.0,15.2,15.4,15.6,15.8,17.0,17.5,18.0,18.5,19.0,22.0,22.5,23.0,23.5,24.0,27.0,27.5,28.0,28.5,29.0,33.0,33.5,34.0,34.5,35.0,39.0,39.5,40.0,40.5,41.0,45.0]; atks.forEach((a,i)=>lv[i+1]={atk:a.toFixed(1)}); return lv; })() },
            "ë§¤ë¨¸ë“œì˜ í˜": { grade: "ì—í”½", imgId: "14UVrJVEIr5xZghRiG96doS_QhOQ0VxBK", desc: "ìœ ë‹›ì˜ í¬ê¸°ê°€ ì»¤ì§€ë©° ìœ ë‹›ì˜ ì²´ë ¥ì´ {hp}% ì¦ê°€í•˜ê³  ê³µê²©ë ¥ì´ 25% ê°ì†Œ", levels: (function(){ let lv={}; const hps=[19.5,20.0,20.5,21.0,21.5,27.0,27.5,28.0,28.5,29.0,34.5,35.5,36.5,37.5,38.5,44.5,45.8,47.0,48.3,49.5,59.5,60.8,62.0,63.3,64.5,79.5,80.8,82.0,83.3,84.5,102.0]; hps.forEach((h,i)=>lv[i+1]={hp:h.toFixed(1)}); return lv; })() },
            "í¡í˜ˆ": { grade: "ìœ ë‹ˆí¬", imgId: "1wpM4jrjnyShM9jkrWQuleCMRQzqajRg-", desc: "ìœ ë‹›ì„ ê³µê²©í•  ë•Œ {prob}% í™•ë¥ ë¡œ ë‚´ ìœ ë‹› ê³µê²©ë ¥ì˜ {value}% ë§Œí¼ ì²´ë ¥ íšŒë³µ", levels: (function(){ let lv={}; const probs=[15,15,15,15,15,15,15,15,15,15,20,20,20,20,20,20,20,20,20,20,25,25,25,25,25,25,25,25,25,25,30]; const vals=[30,32,34,36,38,45,47,49,51,53,55,57,59,61,63,70,72,74,76,78,80,82,84,86,88,95,97,99,101,103,110]; probs.forEach((p,i)=>lv[i+1]={prob:p, value:vals[i]}); return lv; })() },
            "ê°•íƒ€": { grade: "ìœ ë‹ˆí¬", imgId: "1duFRCFWSfwJIT4FcOfDcJU5t9_sYYSNd", desc: "ìœ ë‹› ê³µê²©ë ¥ {value}% ì¦ê°€", levels: (function(){ let lv={}; const vals=[7.0,7.2,7.4,7.6,7.8,10.0,10.2,10.4,10.6,10.8,13.0,13.4,13.8,14.2,14.6,17.0,17.5,18.0,18.5,19.0,23.0,23.5,24.0,24.5,25.0,31.0,31.5,32.0,32.5,33.0,40.0]; vals.forEach((v,i)=>lv[i+1]={value:v.toFixed(1)}); return lv; })() },
            "ë°©ì–´ë²½": { grade: "ìœ ë‹ˆí¬", imgId: "19nNX-o2m8lDQfKLe5YXd7JijVf7HK0iI", desc: "ìœ ë‹› ì²´ë ¥ {value}% ì¦ê°€", levels: (function(){ let lv={}; const vals=[17.5,18.0,18.5,19.0,19.5,25.0,25.5,26.0,26.5,27.0,32.5,33.5,34.5,35.5,36.5,42.5,43.8,45.0,46.3,47.5,57.5,58.8,60.0,61.3,62.5,77.5,78.8,80.0,81.3,82.5,100.0]; vals.forEach((v,i)=>lv[i+1]={value:v.toFixed(1)}); return lv; })() },
            "ë³´ìŠ¤ ìŠ¬ë ˆì´ì–´": { grade: "ìœ ë‹ˆí¬", imgId: "1UaNaWoiuUASIRx62ixYoUTleH-wc_gFI", desc: "ë³´ìŠ¤ë¥¼ ê³µê²©í•  ë•Œ ìœ ë‹›ì˜ ê³µê²©ë ¥ {value}% ì¦ê°€", levels: (function(){ let lv={}; const vals=[20,22,24,26,28,40,42,44,46,48,60,62,64,66,68,80,83,86,89,92,110,115,120,125,130,150,160,170,180,190,250]; vals.forEach((v,i)=>lv[i+1]={value:v.toFixed(1)}); return lv; })() },
            "ë©”í…Œì˜¤": { grade: "ì „ì„¤", imgId: "1fJVyoKiTVH1i0votjXaXuwAbTZjxnM-P", desc: "ìœ ë‹›ì„ ê³µê²©í•  ë•Œ {prob}% í™•ë¥ ë¡œ í˜„ì¬ íƒ€ì¼ì— ìˆëŠ” ëª¨ë“  ì ì—ê²Œ ê³µê²©ë ¥ì˜ {value}% ìŠ¤í‚¬ ì¶”ê°€ í”¼í•´\në ˆì „ë”ë¦¬ íŒ¨ì‹œë¸Œ : ê³µê²©ë ¥{extra}%, ì²´ë ¥{extra}% ì¦ê°€", levels: (function(){ let lv={}; const probs=[50,50,50,50,50,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,60,60,60,60,60,65,65,65,65,65,65]; const dmgs=[15,16,17,18,19,20,21,22,23,24,40,41,42,43,44,50,51,52,53,54,65,66,67,68,69,70,71,72,73,74,80]; const extras=[2,2,2,2,2,2,2,2,2,2,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,10]; probs.forEach((p,i)=>lv[i+1]={prob:p, value:dmgs[i], extra:extras[i]}); return lv; })() },
            "ë‚™ë¢°": { grade: "ì „ì„¤", imgId: "1pPUwyTblvZJDbTAPUOJYr8hdUqPTZmy4", desc: "ìœ ë‹›ì„ ê³µê²©í•  ë•Œ {prob}% í™•ë¥ ë¡œ ì „íˆ¬ì¤‘ì¸ ìƒëŒ€ ìœ ë‹›ì—ê²Œ {value}% ìŠ¤í‚¬ ì¶”ê°€ í”¼í•´\në ˆì „ë”ë¦¬ íŒ¨ì‹œë¸Œ: ê³µê²©ë ¥{extra}%, ì²´ë ¥{extra}% ì¦ê°€", levels: (function(){ let lv={}; const probs=[40,40,40,40,40,45,45,45,45,45,50,50,50,50,50,50,50,50,50,50,60,60,60,60,60,65,65,65,65,65,65]; const dmgs=[40.0,40.5,41.0,41.5,42.0,50.0,50.5,51.0,51.5,52.0,67.5,68.0,68.5,69.0,69.5,82.5,83.0,83.5,84.0,84.5,90.0,90.5,91.0,91.5,92.0,100.0,100.5,101.0,101.5,102.0,115.0]; const extras=[2,2,2,2,2,2,2,2,2,2,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,10]; probs.forEach((p,i)=>lv[i+1]={prob:p, value:dmgs[i], extra:extras[i]}); return lv; })() },
            "ìŠ¹ë¦¬ì˜ í•¨ì„±": { grade: "ì¼ë°˜", imgId: "1kdYTPMnC9sHD_xVfJ7KlMEAmepKrI5U3", levels: {} },
            "ìì—°ì˜ í¬ì˜¹": { grade: "ì¼ë°˜", imgId: "11shDd_9139ob8f3NJpu51kASPqzfDZTF", levels: {} },
            "íŒŒê´´ì 1": { grade: "ì¼ë°˜", imgId: "1gEKQmAPtu3APq91BSK7YlUldIkPQQKV3", levels: {} },
            "ê°•ì¸í•¨ 1": { grade: "ì¼ë°˜", imgId: "1USRrGEG4SiMnOwYYV_IYy0hllT6fXNhN", levels: {} },
            "ë¶€ì¡±ì˜ ì¶•ë³µ 1": { grade: "ì¼ë°˜", imgId: "19K30pdy48M0_TW7kR5Iz8Cxbx5NxYVkX", levels: {} },
            "íŒŒê´´ì 2": { grade: "í¬ê·€", imgId: "1XWpJQ3PShBg43fHvfVgf1f8t0pDoD5mj", levels: {} },
            "ë¶€ì¡±ì˜ ì¶•ë³µ 2": { grade: "í¬ê·€", imgId: "1EIJibIbgJ2EXyMhJT59cSWNACb-ROxxv", levels: {} },
            "íŒŒê´´ì 3": { grade: "ì—í”½", imgId: "1sSwqcPHGFhZIR1i-UfwHuU34NvvDPwN2", levels: {} },
            "ê°•ì¸í•¨ 2": { grade: "ìœ ë‹ˆí¬", imgId: "12R07txrHKhMhwoxbE4M-QBw4mxxOUTxf", levels: {} },
            "ì§€ì§„": { grade: "ìœ ë‹ˆí¬", imgId: "1qH0wEmw_otlxQBBofd-H4kuA2SMKIVKn", levels: {} }
        };
        const TITAN_DATA = (function() {
            let data = [];
            let currentAtk = 5; let currentHp = 2500000;
            for (let lv = 1; lv <= 40; lv++) {
                data.push([lv, currentAtk, currentHp]);
                if (lv < 6) currentAtk += 5; else currentAtk += 15;
                if (lv < 4) currentHp += 2500000; else if (lv === 4) currentHp += 3125000; else currentHp += 3750000;
            }
            return data;
        })();
        let state = { slots: [null,null,null,null,null], activeIdx: null, tempRune: null };
        const titanSel = document.getElementById('targetTitan');
        TITAN_DATA.forEach(t => titanSel.add(new Option(`Lv.${t[0]} (ATK ${t[1]} / HP ${t[2].toLocaleString()})`, t[0])));
        const lvSelect = document.getElementById('runeLevel');
        for(let i=1; i<=31; i++) lvSelect.add(new Option(i + "Lv", i));
        const grid = document.getElementById('runeGrid');
        let separatorAdded = false;
        for (let name in RUNES_DATA) {
            const rune = RUNES_DATA[name];
            if (!separatorAdded && Object.keys(rune.levels).length === 0) {
                const hrContainer = document.createElement('div');
                hrContainer.style.gridColumn = "1 / -1"; hrContainer.style.margin = "15px 0 10px 0";
                hrContainer.innerHTML = `<hr style="border:0; border-top:1px solid #eee; margin-bottom:10px;"><div style="font-size:11px; color:#999; text-align:center; font-weight:bold;">âš ï¸ ì•„ë˜ëŠ” íƒ€ì´íƒ„ì— ì í•©í•˜ì§€ ì•Šì€ ë£¬ì…ë‹ˆë‹¤.</div>`;
                grid.appendChild(hrContainer);
                separatorAdded = true;
            }
            const item = document.createElement('div');
            item.className = 'rune-item';
            if (Object.keys(rune.levels).length === 0) item.style.opacity = "0.7";
            item.innerHTML = `<img src="https://drive.google.com/thumbnail?id=${rune.imgId}&sz=200"><span>${name}</span>`;
            item.onclick = () => selectRuneFromGrid(name, item);
            grid.appendChild(item);
        }
function updateLiveStats() {
    const bA = Number(document.getElementById('baseAtk').value) || 0;
    const bH = Number(document.getElementById('baseHp').value) || 0;
    const titanLv = Number(document.getElementById('targetTitan').value);
    const titanInfo = TITAN_DATA.find(t => t[0] === titanLv);
    const tAtk = titanInfo ? titanInfo[1] : 0;
    let stats = { iA: 0, iH: 0, pA: 0, pH: 0 };
    let defense = { fixed: 0, probFixed: [], healProb: 0, healRate: 0, lsProb: 0, lsRate: 0 };
    state.slots.forEach(s => {
        if(!s) return;
        const e = s.effect, n = s.name;
        if(n.includes("ê³µê²©ë ¥ ì¦ê°€")) stats.iA += Number(e.value || 0);
        if(n.includes("ì²´ë ¥ ì¦ê°€")) stats.iH += Number(e.value || 0);
        if(n === "ê°•íƒ€" || n === "ë³´ìŠ¤ ìŠ¬ë ˆì´ì–´") stats.pA += parseFloat(e.value);
        if(n === "ë°©ì–´ë²½") stats.pH += parseFloat(e.value);
        if(n === "ì••ì¶•ëœ í˜") { stats.pA += parseFloat(e.atk); stats.pH -= 25; }
        if(n === "ë§¤ë¨¸ë“œì˜ í˜") { stats.pH += parseFloat(e.hp); stats.pA -= 25; }
        if(n.includes("ë‹¨ë‹¨í•œ í”¼ë¶€")) defense.fixed += Number(e.value);
        if(n.includes("í”¼í•´ ì €í•­")) defense.probFixed.push({ prob: e.prob/100, value: e.value });
        if(n === "í") { defense.healProb = e.prob/100; defense.healRate = e.value/100; }
        if(n === "í¡í˜ˆ") { defense.lsProb = e.prob/100; defense.lsRate = e.value/100; }
    });
    const fAtk = (bA + stats.iA) * (1 + stats.pA / 100);
    const fHp = (bH + stats.iH) * (1 + stats.pH / 100);
    // 1. ëŒ€ë¯¸ì§€ ê¸°ëŒ“ê°’ (í”¼ê²© 1íšŒë‹¹)
    let expectedDmgReduction = defense.fixed;
    defense.probFixed.forEach(r => expectedDmgReduction += (r.prob * r.value));
    const netDmg = Math.max(0, tAtk - expectedDmgReduction);
    // 2. 3ì´ˆê°„ ì´ íšŒë³µëŸ‰ (í 1íšŒ + í¡í˜ˆ 3íšŒ)
    const expectedHealRune = fHp * defense.healRate * defense.healProb;
    const expectedLifesteal = fAtk * defense.lsRate * defense.lsProb;
    const totalHealIn3Sec = expectedHealRune + (expectedLifesteal * 3);
    // 3. ìˆœìˆ˜ ì²´ë ¥ ë³€ë™ëŸ‰ (ì •ìˆ˜ ê³„ì‚°)
    // íšŒë³µëŸ‰ì—ì„œ ëŒ€ë¯¸ì§€ë¥¼ ëº€ ìˆœìˆ˜ ìˆ˜ì¹˜ì…ë‹ˆë‹¤.
    const hpNetChange = totalHealIn3Sec - netDmg;
    document.getElementById('liveStats').innerHTML = `
        <div class="stat-row"><span>ìµœì¢… ê³µê²©ë ¥:</span><span class="res-val">${Math.floor(fAtk).toLocaleString()}</span></div>
        <div class="stat-row"><span>ìµœì¢… ì²´ë ¥:</span><span class="res-val">${Math.floor(fHp).toLocaleString()}</span></div>
        <div style="border-top:1px dashed #ccc; margin:8px 0;"></div>
        <div class="stat-row"><span>1íšŒ í”¼ê²© ì‹œ ì²´ë ¥ ë³€ë™ ìˆ˜ì¹˜(ê¸°ëŒ“ê°’):</span>
            <span class="res-val" style="color:${hpNetChange >= 0 ? 'green' : 'red'}">
                ${hpNetChange >= 0 ? '+' : ''}${Math.floor(hpNetChange).toLocaleString()}
            </span>
        </div>
        <div class="stat-row"><span>1íšŒ ë°›ëŠ” ëŒ€ë¯¸ì§€(ê¸°ëŒ“ê°’):</span><span class="res-val" style="color:red;">-${netDmg.toFixed(1)}</span></div>
        <div class="stat-row"><span>1íšŒ í”¼ê²© ë‹¹ íšŒë³µ(ê¸°ëŒ“ê°’):</span><span class="res-val" style="color:green;">+${totalHealIn3Sec.toFixed(1)}</span></div>
    `;
// --- ìë™ ì €ì¥ ë¡œì§ ---
    const saveData = {
        baseAtk: document.getElementById('baseAtk').value,
        baseHp: document.getElementById('baseHp').value,
        dinoCount: document.getElementById('dinoCount').value,
        targetTitan: document.getElementById('targetTitan').value,
        slots: state.slots 
    };
    localStorage.setItem('dino_mutant_config', JSON.stringify(saveData));
}
        function startSimulation() {
            document.getElementById('finalStats').innerHTML = `<div style="padding:20px; font-weight:bold; color:#2196F3;">ì‹œë®¬ë ˆì´ì…˜ ì¤‘...</div>`;
            setTimeout(autoCalc, 50);
        }
function autoCalc() {
    const bA = Number(document.getElementById('baseAtk').value) || 0;
    const bH = Number(document.getElementById('baseHp').value) || 0;
    const dinoCount = Number(document.getElementById('dinoCount').value);
    const titanLv = Number(document.getElementById('targetTitan').value);
    const titanInfo = TITAN_DATA.find(t => t[0] === titanLv);
    const tOriginalAtk = titanInfo[1];
    const tMaxHp = titanInfo[2];

    let stats = { iA: 0, iH: 0, pA: 0, pH: 0, cProb: 3, cDmg: 50, lifestealProb: 0, lifestealRate: 0 };
    let lsStats = { iA: 0, pA: 0 };
    let attackRunes = [];
    let defenseRunes = { fixed: 0, probFixed: [], shield: { rate: 0, turns: 0 }, healProb: 0, healRate: 0 };
    const excludedRunes = ["ê³ ë…í•œë¶„ë…¸", "í˜‘ë™ê³µê²©", "ë§ˆì§€ë§‰ì„ ë¬¼", "ìì—°ì˜ í¬ì˜¹", "ìŠ¹ë¦¬ì˜í•¨ì„±", "ë¶€ì¡±ì˜ ì¶•ë³µ", "ë³´ìŠ¤ ìŠ¬ë ˆì´ì–´", "íŒŒê´´ì"];

    state.slots.forEach(s => {
        if(!s) return;
        const e = s.effect, n = s.name;
        const isExcluded = excludedRunes.some(ex => n.includes(ex));
        if(n.includes("ê³µê²©ë ¥ ì¦ê°€")) {
            const val = Number(e.value || 0);
            stats.iA += val; if(!isExcluded) lsStats.iA += val;
        }
        if(n === "ê°•íƒ€" || n === "ë³´ìŠ¤ ìŠ¬ë ˆì´ì–´" || n === "íŒŒê´´ì" || n === "ê³ ë…í•œë¶„ë…¸" || n === "í˜‘ë™ê³µê²©" || n === "ë¶€ì¡±ì˜ ì¶•ë³µ") {
            const val = parseFloat(e.value || 0);
            stats.pA += val; if(!isExcluded) lsStats.pA += val;
        }
        if(n === "ì••ì¶•ëœ í˜") {
            stats.pA += parseFloat(e.atk || 0); if(!isExcluded) lsStats.pA += parseFloat(e.atk || 0);
            stats.pH -= 25;
        }
        if(n.includes("ì²´ë ¥ ì¦ê°€")) stats.iH += Number(e.value || 0);
        if(n === "ë°©ì–´ë²½") stats.pH += parseFloat(e.value || 0);
        if(n === "ë§¤ë¨¸ë“œì˜ í˜") { stats.pH += parseFloat(e.hp || 0); stats.pA -= 25; }
        if(n === "ì¹˜ëª…íƒ€ í™•ë¥ ") stats.cProb += parseFloat(e.value || 0);
        if(n === "ì¹˜ëª…íƒ€ í”¼í•´") stats.cDmg += parseFloat(e.value || 0);
        if(n === "í¡í˜ˆ") { stats.lifestealProb = (e.prob || 0) / 100; stats.lifestealRate = (e.value || 0) / 100; }
        if(n === "íŠ¸ë¦¬í”Œ ì„íŒ©íŠ¸") attackRunes.push({ type: 'triple', rate: (e.value || 0) / 100 });
        if(n === "ë‚™ë¢°" || n === "ë©”í…Œì˜¤") {
            attackRunes.push({ type: 'prob', prob: (e.prob || 0) / 100, rate: (e.value || 0) / 100 });
            if(e.extra) { stats.pA += e.extra; stats.pH += e.extra; }
        }
        if(n.includes("ë‹¨ë‹¨í•œ í”¼ë¶€")) defenseRunes.fixed += Number(e.value || 0);
        if(n.includes("í”¼í•´ ì €í•­")) defenseRunes.probFixed.push({ prob: (e.prob || 0) / 100, value: Number(e.value || 0) });
        if(n === "ë³´í˜¸ë§‰") { defenseRunes.shield.rate = (e.value || 0) / 100; defenseRunes.shield.turns = e.turn || 0; }
        if(n === "í") { defenseRunes.healProb = (e.prob || 0) / 100; defenseRunes.healRate = (e.value || 0) / 100; }
    });

    const fAtk = (bA + stats.iA) * (1 + stats.pA / 100);
    const lsAtk = (bA + lsStats.iA) * (1 + lsStats.pA / 100);
    const fMaxHp = (bH + stats.iH) * (1 + stats.pH / 100);

    const SIM_COUNT = 1000;
    let totalWins = 0, totalDeadSum = 0, totalLifeTimeSum = 0, totalDmgSum = 0;
    let minHpRecords = []; // ëª¨ë“  íŒì˜ ìµœì € ì²´ë ¥ ê¸°ë¡

    for(let i=0; i<SIM_COUNT; i++) {
        let currentTHp = tMaxHp;
        // minHp: ê° ê³µë£¡ì˜ ì´ë²ˆ íŒ ìµœì € ì²´ë ¥ì„ fMaxHpë¡œ ì´ˆê¸°í™”í•˜ì—¬ ì¶”ì 
        let dinos = Array(dinoCount).fill(0).map(() => ({ hp: fMaxHp, minHp: fMaxHp, shield: defenseRunes.shield.turns, hits: 0, alive: true, time: 0 }));
        let time = 0;

        while(currentTHp > 0 && dinos.some(d => d.alive) && time < 7200) {
            time++;
            dinos.forEach(d => {
                if(!d.alive) return;
                d.time++; d.hits++;
                let isCrit = Math.random() < (stats.cProb / 100);
                let dmg = isCrit ? fAtk * (1 + stats.cDmg / 100) : fAtk;
                attackRunes.forEach(r => {
                    if(r.type === 'triple' && d.hits % 3 === 0) dmg += fAtk * r.rate;
                    if(r.type === 'prob' && Math.random() < r.prob) dmg += fAtk * r.rate;
                });
                currentTHp -= dmg; totalDmgSum += dmg;
                if(Math.random() < stats.lifestealProb) d.hp = Math.min(fMaxHp, d.hp + (lsAtk * stats.lifestealRate));
            });

            if(time % 3 === 0 && currentTHp > 0) {
                dinos.forEach(d => {
                    if(!d.alive) return;
                    let tDmg = tOriginalAtk - defenseRunes.fixed;
                    defenseRunes.probFixed.forEach(r => { if(Math.random() < r.prob) tDmg -= r.value; });
                    if(d.shield > 0) { tDmg *= (1 - defenseRunes.shield.rate); d.shield--; }
                    d.hp -= Math.max(0, tDmg);
                    if(Math.random() < defenseRunes.healProb) d.hp = Math.min(fMaxHp, d.hp + (fMaxHp * defenseRunes.healRate));
                    
                    // ìµœì € ì²´ë ¥ ê°±ì‹ 
                    if(d.hp < d.minHp) d.minHp = d.hp;
                    if(d.hp <= 0) { d.hp = 0; d.alive = false; d.minHp = 0; }
                });
            }
        }
        if(currentTHp <= 0) totalWins++;
        totalDeadSum += dinos.filter(d => !d.alive).length;
        dinos.forEach(d => {
            totalLifeTimeSum += d.time;
            minHpRecords.push(Math.max(0, d.minHp)); // ëª¨ë“  ê³µë£¡ì˜ ìµœì € ê¸°ë¡ ìˆ˜ì§‘
        });
    }

   // ... (ì´ì „ ì‹œë®¬ë ˆì´ì…˜ ì—°ì‚° ë¡œì§ì€ ë™ì¼)

    // ê²°ê³¼ ë°ì´í„° ê°€ê³µ
    const avgDead = (totalDeadSum / SIM_COUNT).toFixed(1);
    const avgLife = (totalLifeTimeSum / (SIM_COUNT * dinoCount)).toFixed(1);
    const avgDmg = (totalDmgSum / SIM_COUNT);
    const dmgPercent = (avgDmg / tMaxHp * 100).toFixed(1);
    
    // ìµœì € ì²´ë ¥ í‰ê·  ë° ë¹„ìœ¨ ê³„ì‚°
    const avgMinHp = (minHpRecords.reduce((a, b) => a + b, 0) / minHpRecords.length);
    const minHpPercent = (avgMinHp / fMaxHp * 100);

 // 1. ì•ˆì •ì„± ë©˜íŠ¸ ë° ìƒ‰ìƒ ì„¸ë¶„í™” (7ë‹¨ê³„)
    let stabilityText = "";
    let textColor = "";

    if (parseFloat(avgDead) > 0) {
        stabilityText = "ê³µë£¡ì´ ë²„í‹¸ ìˆ˜ ì—†ìŠµë‹ˆë‹¤";
        textColor = "#8B0000"; // ê²€ë¶‰ì€ìƒ‰
    } else {
        if (minHpPercent <= 10) { stabilityText = "ë§¤ìš° ìœ„í—˜"; textColor = "#FF0000"; } // ë¶‰ì€ìƒ‰
        else if (minHpPercent <= 20) { stabilityText = "ìœ„í—˜"; textColor = "#FF8C00"; } // ì£¼í™©ìƒ‰
        else if (minHpPercent <= 30) { stabilityText = "ë³´í†µ"; textColor = "#FFD700"; } // ë…¸ë€ìƒ‰ (ê³¨ë“œ)
        else if (minHpPercent <= 40) { stabilityText = "ì•ˆì •"; textColor = "#90EE90"; } // ì—°ì´ˆë¡ìƒ‰
        else if (minHpPercent <= 50) { stabilityText = "ë§¤ìš° ì•ˆì •"; textColor = "#008000"; } // ì´ˆë¡ìƒ‰
        else { stabilityText = "ê³µë£¡ì´ ì£½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"; textColor = "#0000FF"; } // íŒŒë€ìƒ‰
    }

    // 2. ê²Œì´ì§€ ë°” ìƒ‰ìƒ ë¡œì§ (3ë‹¨ê³„)
    let barColor = "#f44336"; // 25% ë¯¸ë§Œ ë¹¨ê°•
    if (minHpPercent >= 50) barColor = "#4caf50"; // 50% ì´ìƒ ì´ˆë¡
    else if (minHpPercent >= 25) barColor = "#ffc107"; // 25% ì´ìƒ ë…¸ë‘

    // 3. UI ë Œë”ë§
    document.getElementById('finalStats').innerHTML = `
        <div style="font-weight: bold; font-size: 16px; margin-bottom: 12px; border-bottom: 2px solid #eee; padding-bottom: 8px; color:#444;">
            ğŸ“Š ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼(ì²œ ë²ˆ ë°˜ë³µ ê³„ì‚°)
        </div>
        
        <div style="margin-bottom: 18px;">
            <div style="display:flex; justify-content:space-between; align-items:flex-end; margin-bottom:6px;">
                <span style="font-size: 13px; color: #000;">ê³µë£¡ ì²´ë ¥ ë°”</span>
                <span style="font-size: 16px; font-weight: 900; color: ${textColor};">${stabilityText}</span>
            </div>
            <div style="width: 100%; height: 14px; background: #eee; border-radius: 7px; overflow: hidden; border: 1px solid #ddd;">
                <div style="width: ${minHpPercent}%; height: 100%; background-color: ${barColor}; transition: width 0.3s ease;"></div>
            </div>
            <div style="text-align: right; font-size: 11px; color: #999; margin-top: 4px;">ì²´ë ¥ ìµœì €ì¹˜ ê¸°ë¡ í‰ê· : ${minHpPercent.toFixed(1)}%</div>
        </div>

        <div style="text-align:left; display:inline-block; font-size:14px; width: 100%;">
            <div class="stat-row"><span>â€¢ ì£½ì€ ê³µë£¡ ìˆ˜ í‰ê· :</span> <span class="res-val">${avgDead}ë§ˆë¦¬</span></div>
            <div class="stat-row"><span>â€¢ ê³µë£¡ ìƒì¡´ ì‹œê°„ í‰ê· :</span> <span class="res-val">${avgLife}ì´ˆ</span></div>
            <div class="stat-row"><span>â€¢ íƒ€ì´íƒ„ì—ê²Œ ì¤€ ëŒ€ë¯¸ì§€:</span> <span class="res-val">${Math.floor(avgDmg).toLocaleString()} (${dmgPercent}%)</span></div>
        </div>
    `;
}
        function openPicker(idx) {
            if (state.activeIdx === idx && document.getElementById('runePicker').style.display === 'block') {
                state.activeIdx = null; document.querySelectorAll('.slot').forEach(s => s.classList.remove('active'));
                document.getElementById('runePicker').style.display = 'none'; return;
            }
            state.activeIdx = idx;
            document.querySelectorAll('.slot').forEach((s, i) => i === idx ? s.classList.add('active') : s.classList.remove('active'));
            document.getElementById('runePicker').style.display = 'block';
            if(state.slots[idx]) {
                state.tempRune = state.slots[idx].name; document.getElementById('runeLevel').value = state.slots[idx].level;
                document.getElementById('removeBtn').style.display = 'block'; selectRuneFromGrid(state.tempRune);
            } else { state.tempRune = null; document.getElementById('removeBtn').style.display = 'none'; document.getElementById('detailArea').style.display = 'none'; }
        }
        function selectRuneFromGrid(name, el) {
    state.tempRune = name; 
    document.querySelectorAll('.rune-item').forEach(i => i.style.borderColor = 'transparent');
    if(el) el.style.borderColor = '#2196F3';
    const detailArea = document.getElementById('detailArea');
    detailArea.style.display = 'block'; 
    updateDetail();
    // ì¶”ê°€: ë£¬ í´ë¦­ ì‹œ ë ˆë²¨ ì„¤ì • ì¹¸ìœ¼ë¡œ ìë™ ìŠ¤í¬ë¡¤
    detailArea.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}
        function updateDetail() {
            if (!state.tempRune) return;
            const lv = document.getElementById('runeLevel').value; const data = RUNES_DATA[state.tempRune];
            const gradeEl = document.getElementById('runeGrade');
            gradeEl.innerText = `${data.grade} ë“±ê¸‰`; gradeEl.className = `rune-grade grade-${data.grade}`;
            let d = data.desc; const eff = data.levels[lv];
            if (eff) for (let k in eff) d = d.split(`{${k}}`).join(eff[k]);
            document.getElementById('runeDesc').innerText = d;
        }
        function applyToSlot() {
            const idx = state.activeIdx; const lv = document.getElementById('runeLevel').value;
            const runeName = state.tempRune; if (!runeName || !RUNES_DATA[runeName].levels[lv]) return;
            state.slots.forEach((s, i) => { if (s && s.name === runeName && i !== idx) { state.slots[i] = null; document.getElementById(`slot${i}`).innerHTML = `<small style="color:#ccc">ìŠ¬ë¡¯ ${i+1}</small>`; } });
            state.slots[idx] = { name: runeName, level: lv, effect: RUNES_DATA[runeName].levels[lv] };
            document.getElementById(`slot${idx}`).innerHTML = `<img src="https://drive.google.com/thumbnail?id=${RUNES_DATA[runeName].imgId}&sz=200">`;
            document.getElementById('runePicker').style.display = 'none';
            updateLiveStats();
        }
        function removeRune() {
            state.slots[state.activeIdx] = null;
            document.getElementById(`slot${state.activeIdx}`).innerHTML = `<small style="color:#ccc">ìŠ¬ë¡¯ ${state.activeIdx+1}</small>`;
            document.getElementById('runePicker').style.display = 'none';
            updateLiveStats();
        }
  // --- ìë™ ë¶ˆëŸ¬ì˜¤ê¸° ë¡œì§ ---
const savedData = localStorage.getItem('dino_mutant_config');
if (savedData) {
    const data = JSON.parse(savedData);
    document.getElementById('baseAtk').value = data.baseAtk || 1;
    document.getElementById('baseHp').value = data.baseHp || 10;
    document.getElementById('dinoCount').value = data.dinoCount || 1;
    document.getElementById('targetTitan').value = data.targetTitan || 1;
    
    if (data.slots) {
        state.slots = data.slots;
        state.slots.forEach((s, i) => {
            if (s && RUNES_DATA[s.name]) {
                document.getElementById(`slot${i}`).innerHTML = 
                    `<img src="https://drive.google.com/thumbnail?id=${RUNES_DATA[s.name].imgId}&sz=200">`;
            }
        });
    }
}
// -----------------------
updateLiveStats(); // ê¸°ì¡´ì— ìˆë˜ í˜¸ì¶œë¬¸     
  updateLiveStats();
    </script>
</body>
</html>
